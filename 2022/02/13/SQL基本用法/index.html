<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.0.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"hbinnn.github.io","root":"/","scheme":"Pisces","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":true,"scrollpercent":true},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="通过 MySQL 介绍了 SQL 语句的基本语法。">
<meta property="og:type" content="article">
<meta property="og:title" content="SQL基本用法">
<meta property="og:url" content="http://hbinnn.github.io/2022/02/13/SQL%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/index.html">
<meta property="og:site_name" content="hbinnn&#39;s Blog">
<meta property="og:description" content="通过 MySQL 介绍了 SQL 语句的基本语法。">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://raw.githubusercontent.com/hbinnn/Pictures/master/image-20220212203855996.png">
<meta property="article:published_time" content="2022-02-13T08:33:04.000Z">
<meta property="article:modified_time" content="2022-02-13T08:35:38.338Z">
<meta property="article:author" content="hbinnn">
<meta property="article:tag" content="MySQL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://raw.githubusercontent.com/hbinnn/Pictures/master/image-20220212203855996.png">

<link rel="canonical" href="http://hbinnn.github.io/2022/02/13/SQL%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>SQL基本用法 | hbinnn's Blog</title>
  
    <script async src="https://www.googletagmanager.com/gtag/js?id=G-46K30KQ5B2"></script>
    <script>
      if (CONFIG.hostname === location.hostname) {
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag('js', new Date());
        gtag('config', 'G-46K30KQ5B2');
      }
    </script>






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="切换导航栏">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">hbinnn's Blog</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="http://hbinnn.github.io/2022/02/13/SQL%E5%9F%BA%E6%9C%AC%E7%94%A8%E6%B3%95/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.jpg">
      <meta itemprop="name" content="hbinnn">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="hbinnn's Blog">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          SQL基本用法
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">发表于</span>
              

              <time title="创建时间：2022-02-13 16:33:04 / 修改时间：16:35:38" itemprop="dateCreated datePublished" datetime="2022-02-13T16:33:04+08:00">2022-02-13</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">分类于</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E6%95%B0%E6%8D%AE%E5%BA%93/" itemprop="url" rel="index"><span itemprop="name">数据库</span></a>
                </span>
            </span>

          <br>
            <span class="post-meta-item" title="本文字数">
              <span class="post-meta-item-icon">
                <i class="far fa-file-word"></i>
              </span>
                <span class="post-meta-item-text">本文字数：</span>
              <span>13k</span>
            </span>
            <span class="post-meta-item" title="阅读时长">
              <span class="post-meta-item-icon">
                <i class="far fa-clock"></i>
              </span>
                <span class="post-meta-item-text">阅读时长 &asymp;</span>
              <span>24 分钟</span>
            </span>
            <div class="post-description">通过 MySQL 介绍了 SQL 语句的基本语法。</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <blockquote>
<p>示例 SQL 语句中使用的表均可以在 《MySQL必知必会》 提供的网站中下载。</p>
</blockquote>
<h2 id="SELECT"><a href="#SELECT" class="headerlink" title="SELECT"></a>SELECT</h2><h3 id="检索单个列"><a href="#检索单个列" class="headerlink" title="检索单个列"></a>检索单个列</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name </span><br><span class="line">FROM</span><br><span class="line">    customers;</span><br></pre></td></tr></table></figure>

<blockquote>
<ul>
<li><p>多个 SQL 语句必须以分号（；）分割。</p>
</li>
<li><p>SQL 语句不区分大小写。</p>
</li>
</ul>
</blockquote>
<h3 id="检索多个列"><a href="#检索多个列" class="headerlink" title="检索多个列"></a>检索多个列</h3><p>选择多个列时，列名之间用逗号（，）分割。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers;</span><br></pre></td></tr></table></figure>

<h3 id="检索所有列"><a href="#检索所有列" class="headerlink" title="检索所有列"></a>检索所有列</h3><p>在列名处使用通配符（*）替换。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    * </span><br><span class="line">FROM</span><br><span class="line">    customers;</span><br></pre></td></tr></table></figure>

<h3 id="检索不同的值"><a href="#检索不同的值" class="headerlink" title="检索不同的值"></a>检索不同的值</h3><p>当不希望检索结果出现同样的值时，可以使用关键字 <code>DISTINCT</code> 。<code>DISTINCT</code> 作用于多个列，当检索多个列时，只有多个列都完全相同时，检索结果才不会重复出现。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT DISTINCT</span><br><span class="line">    cust_name </span><br><span class="line">FROM</span><br><span class="line">    customers;</span><br></pre></td></tr></table></figure>

<h3 id="限制检索结果的数量"><a href="#限制检索结果的数量" class="headerlink" title="限制检索结果的数量"></a>限制检索结果的数量</h3><p>对 <code>MySQL</code> 而言，可以通过关键字 <code>LIMIT</code> 来限制检索显示的结果，只检索前几行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">    LIMIT 3;</span><br></pre></td></tr></table></figure>

<p>如果希望从某一行开始检索几行，可以配合关键字 <code>OFFSET</code> 使用：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">    LIMIT 3 OFFSET 1;</span><br></pre></td></tr></table></figure>

<h2 id="ORDER-BY"><a href="#ORDER-BY" class="headerlink" title="ORDER BY"></a>ORDER BY</h2><h3 id="排序数据"><a href="#排序数据" class="headerlink" title="排序数据"></a>排序数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">ORDER BY</span><br><span class="line">    cust_zip;</span><br></pre></td></tr></table></figure>

<p>通过 ORDER BY 子句指定列对检索出的数据进行排序。</p>
<p>ORDER BY 所指出的列并不是必须在 SELECT 指定，但是必须是表中已存在的列。</p>
<h3 id="按多个列排序数据"><a href="#按多个列排序数据" class="headerlink" title="按多个列排序数据"></a>按多个列排序数据</h3><p>如果需要根据多个列排序，则使用 ORDER BY 指出多个列。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">ORDER BY</span><br><span class="line">    cust_zip,</span><br><span class="line">    cust_country;</span><br></pre></td></tr></table></figure>

<p>只有当 cust_zip 相同时才会根据 cust_country 进行排序。</p>
<h3 id="按列位置排序"><a href="#按列位置排序" class="headerlink" title="按列位置排序"></a>按列位置排序</h3><p>ORDER BY 还支持按照检索列的相对位置进行排序。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">ORDER BY</span><br><span class="line">    2;</span><br></pre></td></tr></table></figure>

<p>ORDER BY 2 与 ORDER BY cust_address 的效果相同。</p>
<h3 id="指定排序方向"><a href="#指定排序方向" class="headerlink" title="指定排序方向"></a>指定排序方向</h3><p>ORDER BY 默认是按照升序排序，如果需要降序排序，需要显式指定 DESC 关键字。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">ORDER BY</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address DESC;</span><br></pre></td></tr></table></figure>

<p>DESC 只应用于紧跟着的列名，如果需要对多个列进行降序排序，需要对每个列都指定 ORDER BY；</p>
<p>上述例子中，只会对 cust_address 进行降序排序，而不会对 cust_name 进行降序排序。</p>
<h2 id="WHERE"><a href="#WHERE" class="headerlink" title="WHERE"></a>WHERE</h2><h3 id="过滤数据"><a href="#过滤数据" class="headerlink" title="过滤数据"></a>过滤数据</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">WHERE</span><br><span class="line">    cust_email IS NULL;</span><br></pre></td></tr></table></figure>

<p>数据根据 WHERE 子句中指定的条件进行过滤。WHERE 支持的操作符有：</p>
<p>=、&lt;&gt;（不等于）、~=、&lt;、&lt;=、!&lt;（不小于）、&gt;、&gt;=、!&gt;（不大于）、BETWEEN .. AND …（在指定的两个值之间）、IS NULL（为 NULL 值）。</p>
<blockquote>
<p>WHERE 与 OEDER BY 同时使用时，需要让 OEDER BY 位于 WHERE 之后。</p>
</blockquote>
<h3 id="组合-WHERE-子句"><a href="#组合-WHERE-子句" class="headerlink" title="组合 WHERE 子句"></a>组合 WHERE 子句</h3><p>使用 AND 或者 OR 关键字组合过滤条件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">WHERE</span><br><span class="line">    cust_name = &#x27;Fun4All&#x27; </span><br><span class="line">    AND cust_state = &#x27;IN&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="指定条件范围"><a href="#指定条件范围" class="headerlink" title="指定条件范围"></a>指定条件范围</h3><p>通过关键字 IN 指定条件范围，范围内的条件都可以进行匹配。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">WHERE</span><br><span class="line">    cust_name IN ( &#x27;Fun4All&#x27;, &#x27;Kids Place&#x27; );</span><br></pre></td></tr></table></figure>

<h3 id="否定条件"><a href="#否定条件" class="headerlink" title="否定条件"></a>否定条件</h3><p>通过关键字 NOT 否定了 WHERE 子句中的过滤条件。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_address </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">WHERE</span><br><span class="line">    NOT cust_email IS NULL;</span><br></pre></td></tr></table></figure>

<h2 id="LIKE"><a href="#LIKE" class="headerlink" title="LIKE"></a>LIKE</h2><h3 id="通配符"><a href="#通配符" class="headerlink" title="% 通配符"></a>% 通配符</h3><p>% 表示匹配任意字符出现任意次数。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name LIKE &#x27;% inch%&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="通配符-1"><a href="#通配符-1" class="headerlink" title="_ 通配符"></a>_ 通配符</h3><p>_ 只匹配单个字符而不是任意个字符。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name LIKE &#x27;_ inch%&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="REGEXP"><a href="#REGEXP" class="headerlink" title="REGEXP"></a>REGEXP</h2><h3 id="基本字符匹配"><a href="#基本字符匹配" class="headerlink" title="基本字符匹配"></a>基本字符匹配</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name REGEXP &#x27;1000&#x27;;</span><br></pre></td></tr></table></figure>

<p>上述例子也可以通过 LIKE 来实现。LIKE 与 REGEXP 的一个区别是，LIKE 需要被匹配的文件是整个列，而 REGEXP 只需要被匹配的文本在列中出现即可。</p>
<h3 id="OR-匹配"><a href="#OR-匹配" class="headerlink" title="OR 匹配"></a>OR 匹配</h3><p>通过使用 | 来匹配多个正则表达式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name REGEXP &#x27;1000|2000&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="匹配"><a href="#匹配" class="headerlink" title="[] 匹配"></a>[] 匹配</h3><p>[] 匹配其实就是另一种形式的 OR 匹配。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name REGEXP &#x27;[123] ton&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="范围匹配"><a href="#范围匹配" class="headerlink" title="范围匹配"></a>范围匹配</h3><p>可以通过 [] 定义一个范围来进行匹配。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name REGEXP &#x27;[1-3] ton&#x27;;</span><br></pre></td></tr></table></figure>

<p>同样可以否定 [] 支持的范围，只需要在 [] 内开始处加一个 ^。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name REGEXP &#x27;[^1-3] ton&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="匹配特殊字符"><a href="#匹配特殊字符" class="headerlink" title="匹配特殊字符"></a>匹配特殊字符</h3><p>通过使用转义字符 <code>\\</code> 来匹配特殊的字符。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name </span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">WHERE</span><br><span class="line">    vend_name REGEXP &#x27;\\.&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="匹配字符类"><a href="#匹配字符类" class="headerlink" title="匹配字符类"></a>匹配字符类</h3><p>可以使用预定义的字符集来匹配。</p>
<p>预定义字符集有：</p>
<ul>
<li>[:alnum:]：任意字母和数字；</li>
<li>[:alpha:]：任意字母；</li>
<li>[:digit:]：任意数字；</li>
<li>[:xdigit:]：任意十六进制数字；</li>
<li>[:blank:]：空格和制表符；</li>
<li>[:sapce:]：任意空白字符；</li>
<li>[:cntrl:]：ASCII 控制字符（0 - 31 以及 127）；</li>
<li>[:print:]：任意可打印字符；</li>
<li>[:graph:]：与 [:print:] 相同，但是不包括空格；</li>
<li>[:lower:]：任意小写字母；</li>
<li>[:upper:]：任意大写字母；</li>
<li>[:punct:]：既不在 [:alnum:] 又不在 [:cntrl:] 中的任意字符；</li>
</ul>
<h3 id="匹配多个实例"><a href="#匹配多个实例" class="headerlink" title="匹配多个实例"></a>匹配多个实例</h3><p>通过正则表达式重复元字符控制对正则表达式进行若干次匹配。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_name </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_name REGEXP &#x27;\\([0-9] sticks?\\)&#x27;;</span><br></pre></td></tr></table></figure>

<p>重复元字符：</p>
<ul>
<li>*：0或多个匹配；</li>
<li>+：1或多个匹配；</li>
<li>?：0或1个匹配；</li>
<li>{n}：指定数目的匹配；</li>
<li>{n, }：不少于指定数目的匹配；</li>
<li>{n, m}：匹配数目的范围（m 不超过255）；</li>
</ul>
<h3 id="定位符"><a href="#定位符" class="headerlink" title="定位符"></a>定位符</h3><p>通过定位符控制匹配的位置。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_price</span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_price REGEXP &#x27;^5&#x27;;</span><br></pre></td></tr></table></figure>

<p>定位符：</p>
<ul>
<li>^：文本的开始；</li>
<li>$：文本的结尾；</li>
</ul>
<h2 id="拼接字段"><a href="#拼接字段" class="headerlink" title="拼接字段"></a>拼接字段</h2><h3 id="Concat"><a href="#Concat" class="headerlink" title="Concat()"></a>Concat()</h3><p>使用 Concat() 函数将多个列拼接成一个列。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    CONCAT( prod_id, &#x27;(&#x27;, vend_id, &#x27;)&#x27; ) </span><br><span class="line">FROM</span><br><span class="line">    products;</span><br></pre></td></tr></table></figure>

<h3 id="使用别名"><a href="#使用别名" class="headerlink" title="使用别名"></a>使用别名</h3><p>用 AS 将拼接出的字段赋予一个别名显示。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    CONCAT( prod_id, &#x27;(&#x27;, vend_id, &#x27;)&#x27; ) AS title </span><br><span class="line">FROM</span><br><span class="line">    products;</span><br></pre></td></tr></table></figure>

<h2 id="计算字段"><a href="#计算字段" class="headerlink" title="计算字段"></a>计算字段</h2><p>计算字段不实际存在于数据库表中，实在运行时 SELECT 语句内创建的。</p>
<p>对检索出的数据可以创建计算字段进行算术计算。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    prod_id,</span><br><span class="line">    quantity,</span><br><span class="line">    item_price,</span><br><span class="line">    quantity * item_price AS price </span><br><span class="line">FROM</span><br><span class="line">    orderitems </span><br><span class="line">WHERE</span><br><span class="line">    order_num = 20005;</span><br></pre></td></tr></table></figure>

<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><h3 id="文本处理函数"><a href="#文本处理函数" class="headerlink" title="文本处理函数"></a>文本处理函数</h3><p>常见文本处理函数：</p>
<ul>
<li><p>Left(): 返回串左边的字符；</p>
</li>
<li><p>Right(): 返回串右边的字符；</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name,</span><br><span class="line">    RIGHT ( vend_name, 5 ) AS vend_right_name </span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">ORDER BY</span><br><span class="line">    vend_name;</span><br></pre></td></tr></table></figure>

<ul>
<li>Length(): 返回串的长度；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name,</span><br><span class="line">    LENGTH( vend_name ) AS vend_length </span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">ORDER BY</span><br><span class="line">    vend_name;</span><br></pre></td></tr></table></figure>

<ul>
<li>Locate(): 找出串的一个字串，返回字串第一次出现的位置，不存在返回0；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name,</span><br><span class="line">    LOCATE( &#x27;ACM&#x27;, vend_name ) AS vend_substr </span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">ORDER BY</span><br><span class="line">    vend_name;</span><br></pre></td></tr></table></figure>

<ul>
<li>SubString(): 返回字串的字符；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name,</span><br><span class="line">    substring( vend_name FROM 1 FOR 5 ) AS vend_substr </span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">ORDER BY</span><br><span class="line">    vend_name;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>Lower(): 串转换为小写；</p>
</li>
<li><p>Upper(): 串转换为大写；</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name,</span><br><span class="line">    UPPER( vend_name ) AS vend_upcase</span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">ORDER BY</span><br><span class="line">    vend_name;</span><br></pre></td></tr></table></figure>

<ul>
<li><p>LTrim(): 去掉左边的空格;</p>
</li>
<li><p>RTrim(): 去掉右边的空格;</p>
</li>
<li><p>Trim(): 去掉两边的空格;</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_name,</span><br><span class="line">    TRIM( vend_name ) AS vend_substr </span><br><span class="line">FROM</span><br><span class="line">    vendors </span><br><span class="line">ORDER BY</span><br><span class="line">    vend_name;</span><br></pre></td></tr></table></figure>

<h3 id="日期与时间处理函数"><a href="#日期与时间处理函数" class="headerlink" title="日期与时间处理函数"></a>日期与时间处理函数</h3><p>MySQL 使用的日期格式为 YYYY-MM-DD。<br>常用的日期与时间处理函数：</p>
<ul>
<li><p>AddDate(): 增加一个日期（天、周等）；</p>
</li>
<li><p>AddTime(): 增加一个时间（时、分等）；</p>
</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    order_date,</span><br><span class="line">    ADDDATE( order_date, INTERVAL 1 YEAR ) AS next_year,</span><br><span class="line">    ADDDATE( order_date, INTERVAL -1 MONTH ) AS last_month,</span><br><span class="line">    ADDDATE( order_date, INTERVAL 1 DAY ) AS next_day,</span><br><span class="line">    ADDTIME( order_date, &#x27;2:0:0&#x27; ) AS next_two_hour </span><br><span class="line">FROM</span><br><span class="line">    orders;</span><br></pre></td></tr></table></figure>

<ul>
<li>CurDate(): 返回当前日期；</li>
<li>CurTime(): 返回当前时间；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    CONCAT( CURDATE(), &#x27; &#x27;, CURTIME()) AS time;</span><br></pre></td></tr></table></figure>

<ul>
<li>Date(): 返回日期时间的日期部分；</li>
<li>Time(): 返回日期时间的时间部分；</li>
<li>Year(): 返回日期的年份部分；</li>
<li>Month(): 返回日期的月份部分；</li>
<li>Day(): 返回一个日期的天数部分；</li>
<li>Hour(): 返回一个时间的小时部分；</li>
<li>Minute(): 返回一个时间的分钟部分；</li>
<li>Second(): 返回一个时间的秒部分；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SELECT DAY(CURDATE());</span><br></pre></td></tr></table></figure>

<h3 id="数值处理函数"><a href="#数值处理函数" class="headerlink" title="数值处理函数"></a>数值处理函数</h3><p>常见数值处理函数：</p>
<ul>
<li>Abs(): 返回绝对值；</li>
<li>Rand(): 返回一个随机数；</li>
<li>…</li>
</ul>
<h3 id="聚集函数"><a href="#聚集函数" class="headerlink" title="聚集函数"></a>聚集函数</h3><p>常用聚集函数：</p>
<ul>
<li>AVG(): 返回某列的平均值；</li>
<li>COUNT(): 返回某列的行数；</li>
<li>MAX(): 返回某列的最大值；</li>
<li>MIN(): 返回某列的最小值；</li>
<li>SUM(): 返回某列值之和；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    AVG( prod_price ) AS avg_price,</span><br><span class="line">    COUNT( prod_price ) AS price_num,</span><br><span class="line">    MAX( prod_price ) AS max_price,</span><br><span class="line">    min( prod_price ) AS min_price,</span><br><span class="line">    SUM( prod_price ) AS sum_price </span><br><span class="line">FROM</span><br><span class="line">    products;</span><br></pre></td></tr></table></figure>

<p>在使用聚集函数时，如果希望只包含不同的值，可以使用关键字 DISTINCT。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    COUNT( prod_price ) AS price_num,</span><br><span class="line">    COUNT( DISTINCT prod_price ) AS price_DISTINCT_num,</span><br><span class="line">FROM</span><br><span class="line">    products;</span><br></pre></td></tr></table></figure>

<h2 id="GROUP-BY"><a href="#GROUP-BY" class="headerlink" title="GROUP BY"></a>GROUP BY</h2><p>GROUP BY 指出 检索出的数据是如何来分组的。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    count(*) AS prod_num </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">GROUP BY</span><br><span class="line">    vend_id;</span><br></pre></td></tr></table></figure>

<p>SELECT 中指出的列都必须在 GROUP BY 出现，否则会出现非预期的结构。</p>
<p>GROUP BY 语句需要在 WHERE 之后，ORDER BY 之前。</p>
<h3 id="过滤分组"><a href="#过滤分组" class="headerlink" title="过滤分组"></a>过滤分组</h3><p>使用 HAVING 来过滤分组。WHERE 过滤的是行，不能用于分组。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    count(*) AS prod_num </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">GROUP BY</span><br><span class="line">    vend_id </span><br><span class="line">HAVING</span><br><span class="line">    count(*) &gt;= 3;</span><br></pre></td></tr></table></figure>

<h2 id="子查询"><a href="#子查询" class="headerlink" title="子查询"></a>子查询</h2><p>子查询，即嵌套在其他查询中的查询，可以把一个 SELECT 语句的结果用于另一条 SELECT 语句的 WHERE 子句。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_id </span><br><span class="line">FROM</span><br><span class="line">    orders </span><br><span class="line">WHERE</span><br><span class="line">    order_num IN ( SELECT order_num FROM orderitems WHERE prod_id = &#x27;TNT2&#x27; );</span><br></pre></td></tr></table></figure>

<h3 id="作为计算字段使用子查询"><a href="#作为计算字段使用子查询" class="headerlink" title="作为计算字段使用子查询"></a>作为计算字段使用子查询</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_state,</span><br><span class="line">    ( SELECT count(*) FROM orders WHERE orders.cust_id = customers.cust_id ) AS orders </span><br><span class="line">FROM</span><br><span class="line">    customers </span><br><span class="line">ORDER BY</span><br><span class="line">    cust_name;</span><br></pre></td></tr></table></figure>

<p>这里计算字段的 WHERE 语句有点不一样，使用了完全限定列名，在列名可能出现二义性时就必须用这种方式。</p>
<h2 id="联结"><a href="#联结" class="headerlink" title="联结"></a>联结</h2><p>联结用于组合来自多个表中的行。</p>
<p><img src="https://raw.githubusercontent.com/hbinnn/Pictures/master/image-20220212203855996.png" alt="image-20220212203855996"></p>
<p>（图片来源：<a target="_blank" rel="noopener" href="https://www.begtut.com/sql/sql-join.html">SQL JOINS | 新手教程 (begtut.com)</a>）</p>
<p>子查询中的例子也可以用如下方式查询：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_id </span><br><span class="line">FROM</span><br><span class="line">    orders</span><br><span class="line">    INNER JOIN orderitems </span><br><span class="line">ON</span><br><span class="line">    orders.order_num = orderitems.order_num </span><br><span class="line">    AND prod_id = &#x27;TNT2&#x27;;</span><br></pre></td></tr></table></figure>

<h2 id="组合查询"><a href="#组合查询" class="headerlink" title="组合查询"></a>组合查询</h2><p>使用 UNION 组合多条 SQL 查询。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_price </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_price &lt; 5 UNION</span><br><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_price </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    vend_id IN ( 1001, 1002 );</span><br></pre></td></tr></table></figure>

<p>UNION 查询时 多个 SQL 语句必须包含相同的列、表达式或聚集函数，SQL 语句见各个列并不需要按相同的顺序指出。</p>
<p>UNION 返回的数据自动去除了重复的行。如果需要，可以使用 UNION ALL。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_price </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_price &lt; 5 UNION ALL</span><br><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_price </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    vend_id IN ( 1001, 1002 );</span><br></pre></td></tr></table></figure>

<p>如果需要对 UNION 返回的数据进行排序，只能有一条 ORDER BY 语句并放在最后一条 SQL 中，不存在用一种顺序排序一部分，另一种顺序排序另一部分。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_price </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    prod_price &lt; 5 UNION ALL</span><br><span class="line">SELECT</span><br><span class="line">    vend_id,</span><br><span class="line">    prod_id,</span><br><span class="line">    prod_price </span><br><span class="line">FROM</span><br><span class="line">    products </span><br><span class="line">WHERE</span><br><span class="line">    vend_id IN ( 1001, 1002 ) </span><br><span class="line">ORDER BY</span><br><span class="line">    prod_price;</span><br></pre></td></tr></table></figure>

<h2 id="全文本搜索"><a href="#全文本搜索" class="headerlink" title="全文本搜索"></a>全文本搜索</h2><p>MyISAM 引擎支持全文本搜索而 InnoDB 不支持。</p>
<p>启动全文本搜索支持：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE productnotes (</span><br><span class="line">  note_id int NOT NULL AUTO_INCREMENT,</span><br><span class="line">  prod_id char(10) NOT NULL,</span><br><span class="line">  note_date datetime NOT NULL,</span><br><span class="line">  note_text text,</span><br><span class="line">  PRIMARY KEY (note_id),</span><br><span class="line">  FULLTEXT (note_text)</span><br><span class="line">) ENGINE=MyISAM</span><br></pre></td></tr></table></figure>

<p>根据 FULLTEXT(note_text) 对它进行索引。</p>
<p>在索引之后，使用 Match() 和 Against() 执行全文本搜索，Match() 指定被索引的列，Against() 指定要使用的索引表达式。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    note_text </span><br><span class="line">FROM</span><br><span class="line">    productnotes </span><br><span class="line">WHERE</span><br><span class="line">    MATCH ( note_text ) Against ( &#x27;rabbit&#x27; );</span><br></pre></td></tr></table></figure>

<p>全文本搜索返回的顺序按照文本匹配的良好程度排序，具有较高等级的行先返回。</p>
<p>查看排序计算的等级值：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    note_text,</span><br><span class="line">    MATCH ( note_text ) Against ( &#x27;rabbit&#x27; ) as rank_</span><br><span class="line">FROM</span><br><span class="line">    productnotes;</span><br></pre></td></tr></table></figure>

<h3 id="查询扩展"><a href="#查询扩展" class="headerlink" title="查询扩展"></a>查询扩展</h3><p>查询扩展不仅返回所有匹配的行，还将返回与匹配行相关的行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    note_text </span><br><span class="line">FROM</span><br><span class="line">    productnotes </span><br><span class="line">WHERE</span><br><span class="line">    MATCH ( note_text ) against ( &#x27;anvils&#x27; WITH QUERY EXPANSION );</span><br></pre></td></tr></table></figure>

<h3 id="布尔文本查询"><a href="#布尔文本查询" class="headerlink" title="布尔文本查询"></a>布尔文本查询</h3><p>布尔方式可以提供关于内容的细节：</p>
<ul>
<li>要匹配的词；</li>
<li>要排斥的词；</li>
<li>排列提示；</li>
<li>表达式分组；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    note_text </span><br><span class="line">FROM</span><br><span class="line">    productnotes </span><br><span class="line">WHERE</span><br><span class="line">    MATCH ( note_text ) against ( &#x27;heavy -rope*&#x27; IN BOOLEAN MODE );</span><br></pre></td></tr></table></figure>

<p>支持的全文本布尔操作符有：</p>
<ul>
<li>+：词必须包含；</li>
<li>-：词必须排除；</li>
<li>&gt;：包含，增加等级值；</li>
<li>&lt;：包含，减少等级值；</li>
<li>()：把词组成表达式；</li>
<li>~：取消一个词的排序值；</li>
<li>*：词尾的通配符；</li>
<li>“”：定义一个短语；</li>
</ul>
<h2 id="INSERT"><a href="#INSERT" class="headerlink" title="INSERT"></a>INSERT</h2><p>插入完整的行</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customers</span><br><span class="line">VALUES</span><br><span class="line">    ( NULL, &#x27;Pen&#x27;, &#x27;100 Street&#x27;, &#x27;HANGZHOU&#x27;, &#x27;AA&#x27;, &#x27;1111&#x27;, &#x27;CN&#x27;, &#x27;NULL&#x27;, &#x27;NULL&#x27; );</span><br></pre></td></tr></table></figure>

<p>INSERT 一般不会产生输入。</p>
<p>这种插入方式需要依赖表中列的定义顺序，可以在 INSERT 语句中指出要插入的列来避免这种情况。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO customers ( cust_id, cust_name, cust_address, cust_city, cust_state, cust_zip, cust_country, cust_contact, cust_email )</span><br><span class="line">VALUES</span><br><span class="line">    ( NULL, &#x27;Pen&#x27;, &#x27;100 Street&#x27;, &#x27;HANGZHOU&#x27;, &#x27;AA&#x27;, &#x27;1111&#x27;, &#x27;CN&#x27;, &#x27;NULL&#x27;, &#x27;NULL&#x27; );</span><br><span class="line">SELECT</span><br><span class="line">    * </span><br><span class="line">FROM</span><br><span class="line">    customers;</span><br></pre></td></tr></table></figure>

<p>插入多个行，只要在 VALUES 之间用逗号分隔开即可</p>
<h3 id="插入检索出的数据"><a href="#插入检索出的数据" class="headerlink" title="插入检索出的数据"></a>插入检索出的数据</h3><p>INSERT 还可以与 SELECT 配合使用将 SELECT 检索出的结果插入到表中。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">INSERT INTO newproductnotes ( note_id, prod_id, note_date, note_text ) SELECT</span><br><span class="line">note_id,</span><br><span class="line">prod_id,</span><br><span class="line">note_date,</span><br><span class="line">note_text </span><br><span class="line">FROM</span><br><span class="line">    productnotes;</span><br></pre></td></tr></table></figure>

<p>实际上，SELECT 与 INSERT 并不要求列名匹配。MySQL 在填充时使用的是列的位置，也即 SELECT 返回的第一列用于填充 INSERT 字段中的第一列。</p>
<h2 id="UPDATE"><a href="#UPDATE" class="headerlink" title="UPDATE"></a>UPDATE</h2><p>使用 WHERE 筛选出需要更新的行，如果不筛选，则更新所有行。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">UPDATE newproductnotes </span><br><span class="line">SET note_date = ADDDATE( note_date, INTERVAL 1 DAY ) </span><br><span class="line">WHERE</span><br><span class="line">    note_id &lt; 110;</span><br></pre></td></tr></table></figure>

<p>更新多个列时只要用 set 设置多个列即可。</p>
<p>在使用 UPDATE 更新时，如果出现错误，则整个 UPDATE 操作被取消。如果希望发生错误也继续更新，可以使用 IGNORE 关键字。UPDATE IGNORE… 。</p>
<h3 id="DELETE"><a href="#DELETE" class="headerlink" title="DELETE"></a>DELETE</h3><p>与 UPDATE 相同，同样使用 WHERE 筛选所需要的行进行删除。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">DELETE </span><br><span class="line">FROM</span><br><span class="line">    newproductnotes </span><br><span class="line">WHERE</span><br><span class="line">    note_id &lt; 110;</span><br></pre></td></tr></table></figure>

<h2 id="CREATE"><a href="#CREATE" class="headerlink" title="CREATE"></a>CREATE</h2><p>使用 CREATE TABLE 创建表。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">CREATE TABLE newproductnotes2 (</span><br><span class="line">  note_id int NOT NULL AUTO_INCREMENT,</span><br><span class="line">  prod_id char(10) NOT NULL,</span><br><span class="line">  note_date datetime NOT NULL DEFAULT &#x27;1970-01-01 00:00:00&#x27;,</span><br><span class="line">  note_text text,</span><br><span class="line">  PRIMARY KEY (note_id),</span><br><span class="line">  FULLTEXT (note_text)</span><br><span class="line">) ENGINE=MyISAM</span><br></pre></td></tr></table></figure>

<p>CREATE TABLE 之后跟表名。在创建新表时，指定的表名应当不存在，否则会出错。</p>
<p>NOT NULL 指出该列的值不能为 NULL，也即插入数据时该列不能为空。允许为 NULL 值的列在插入数据时可以不给出值。如果不显式指定，默认时 NULL。</p>
<p>PRIMARY KEY 指出表的主键。主键值必须唯一。如果使用多个主键，则组合值必须唯一。</p>
<p>AUTO_INCREMENT 指出在每增加一行时该列的值自动增加，如此在插入数据时可以不指定该列的值。当然也可以在插入时指定值，只要它在表中时唯一的即可，后续增量将从该手工插入的值开始。每个表只能有一个 AUTO_INCREMENT 列，并且它必须被索引。</p>
<blockquote>
<p>经实验，AUTO_INCREMENT 的递增值只有在手工插入值比其大时才会变更，插入值比当前递增值小时不会变。假设 下一个递增值是 110，此时手动指定108插入，下一次不指定让其自动递增是111，不会变成109。</p>
</blockquote>
<p>创建表时可以使用关键字 DEFAULT 指定列中的默认值，在插入时如果未指定值则使用默认值。</p>
<p>ENGINE 指出表使用的内部引擎。</p>
<h3 id="更新表"><a href="#更新表" class="headerlink" title="更新表"></a>更新表</h3><p>使用 ALTER TABLE 更新表结构。</p>
<p>添加列：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE newproductnotes2 ADD note_type CHAR ( 20 );</span><br></pre></td></tr></table></figure>

<p>删除列：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE newproductnotes2 DROP note_type;</span><br></pre></td></tr></table></figure>

<p>ALTER TABLE 也可以用来定义外键。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">ALTER TABLE newproductnotes2 </span><br><span class="line">ADD CONSTRAINT fk_note_id </span><br><span class="line">FOREIGN KEY ( note_id ) REFERENCES newproductnotes ( note_id );</span><br></pre></td></tr></table></figure>

<h3 id="删除表"><a href="#删除表" class="headerlink" title="删除表"></a>删除表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TABLE newproductnotes2;</span><br></pre></td></tr></table></figure>

<h3 id="重命名表"><a href="#重命名表" class="headerlink" title="重命名表"></a>重命名表</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">RENAME TABLE newproductnotes TO np2;</span><br></pre></td></tr></table></figure>

<h2 id="视图"><a href="#视图" class="headerlink" title="视图"></a>视图</h2><p>视图是虚拟的表，只包含使用时动态检索数据的查询。简单来说，视图可以将一个复杂的 SQL 语句包装起来，简化复杂的操作。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_contact </span><br><span class="line">FROM</span><br><span class="line">    customers,</span><br><span class="line">    orders,</span><br><span class="line">    orderitems </span><br><span class="line">WHERE</span><br><span class="line">    customers.cust_id = orders.cust_id </span><br><span class="line">    AND orderitems.order_num = orders.order_num </span><br><span class="line">    AND prod_id = &#x27;TNT2&#x27;;</span><br></pre></td></tr></table></figure>

<p>可以通过创建视图简化上述操作。</p>
<p>CREATE VIEW viewname; 创建一个新的视图。</p>
<p>SHOW CREATE VIEW viewname; 查看创建的视图。</p>
<p>DROP VIEW viewname; 删除视图。</p>
<p>更新视图可以先 DROP 再 CREATE，也可以直接使用 CREATE OR REPLACE VIEW 来更新。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">CREATE VIEW productcustomers AS SELECT</span><br><span class="line">cust_name,</span><br><span class="line">cust_contact, </span><br><span class="line">prod_id </span><br><span class="line">FROM</span><br><span class="line">    customers,</span><br><span class="line">    orders,</span><br><span class="line">    orderitems </span><br><span class="line">WHERE</span><br><span class="line">    customers.cust_id = orders.cust_id </span><br><span class="line">    AND orderitems.order_num = orders.order_num;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">SELECT</span><br><span class="line">    cust_name,</span><br><span class="line">    cust_contact </span><br><span class="line">FROM</span><br><span class="line">    productcustomers </span><br><span class="line">WHERE</span><br><span class="line">    prod_id = &#x27;TNT2&#x27;;</span><br></pre></td></tr></table></figure>

<h3 id="更新视图"><a href="#更新视图" class="headerlink" title="更新视图"></a>更新视图</h3><p>由于视图只是一个虚拟的表，更新视图实际上是对视图中所使用的表进行更新。但不是所有的视图都可以更新。包含以下操作的视图不能进行更新：</p>
<ul>
<li>GROUP BY 、 HAVING；</li>
<li>联结；</li>
<li>子查询；</li>
<li>并；</li>
<li>聚集函数；</li>
<li>DISTINCT；</li>
<li>计算字段；</li>
</ul>
<h2 id="存储过程"><a href="#存储过程" class="headerlink" title="存储过程"></a>存储过程</h2><p>存储过程，即一条或多条 SQL 语句的集合。</p>
<h3 id="创建存储过程"><a href="#创建存储过程" class="headerlink" title="创建存储过程"></a>创建存储过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE productpricing (</span><br><span class="line">    OUT pl DECIMAL ( 8, 2 ),</span><br><span class="line">    OUT ph DECIMAL ( 8, 2 ),</span><br><span class="line">    OUT pa DECIMAL ( 8, 2 )) BEGIN</span><br><span class="line">    SELECT</span><br><span class="line">        MIN( prod_price ) INTO pl </span><br><span class="line">    FROM</span><br><span class="line">        products;</span><br><span class="line">    SELECT</span><br><span class="line">        MAX( prod_price ) INTO ph </span><br><span class="line">    FROM</span><br><span class="line">        products;</span><br><span class="line">    SELECT</span><br><span class="line">        AVG( prod_price ) INTO pa </span><br><span class="line">    FROM</span><br><span class="line">    products;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<p>存储过程可以接受参数。关键字 OUT 表明相应参数从存储过程中传出，IN 表明相应参数从外传递给存储过程，INOUT则即传入又传出。</p>
<p>INTO 关键字表明将结果存储给相应的变量。</p>
<p>可以使用 DECLARE 在存储过程内部定义局部变量。例如</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DECLARE total DECIMAL(8, 2);</span><br></pre></td></tr></table></figure>



<blockquote>
<p>存储过程 END 结尾也是使用；作为分隔符。这样有可能导致存储过程内部的；不会被当作存储过程的一部分。因此可以通过临时更改分隔符的方式解决。</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">DELIMITER //</span><br><span class="line">CREATE PROCEDURE productpricing2 () BEGIN</span><br><span class="line">    SELECT</span><br><span class="line">        AVG( prod_price ) </span><br><span class="line">    FROM</span><br><span class="line">        products;</span><br><span class="line">    </span><br><span class="line">END // </span><br><span class="line">DELIMITER;</span><br></pre></td></tr></table></figure>
</blockquote>
<h3 id="执行存储过程"><a href="#执行存储过程" class="headerlink" title="执行存储过程"></a>执行存储过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">CALL productpricing ( @pricelow, @pricehigh, @priceaverage );</span><br><span class="line">SELECT</span><br><span class="line">    @pricelow,</span><br><span class="line">    @pricehigh,</span><br><span class="line">    @priceaverage;</span><br></pre></td></tr></table></figure>

<p>所有变量都要以 @ 开始。</p>
<h3 id="删除存储过程"><a href="#删除存储过程" class="headerlink" title="删除存储过程"></a>删除存储过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP PROCEDURE productpricing;</span><br></pre></td></tr></table></figure>

<h3 id="查看存储过程"><a href="#查看存储过程" class="headerlink" title="查看存储过程"></a>查看存储过程</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">SHOW CREATE PROCEDURE productpricing;</span><br></pre></td></tr></table></figure>

<p>获得详细的存储过程列表，可以使用 SHOW PROCEDURE STATUS;</p>
<h2 id="游标"><a href="#游标" class="headerlink" title="游标"></a>游标</h2><p>游标主要用于在检索出的数据中前进或者后退一行。MySQL 中游标只能用于存储过程。</p>
<p>在使用游标前必须先定义，声明后必须打开才能使用，使用后必须关闭游标。</p>
<h3 id="创建游标"><a href="#创建游标" class="headerlink" title="创建游标"></a>创建游标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders () BEGIN</span><br><span class="line">    DECLARE</span><br><span class="line">        ordernumbers CURSOR FOR SELECT</span><br><span class="line">        order_num </span><br><span class="line">    FROM</span><br><span class="line">    orders;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<h3 id="打开和关闭游标"><a href="#打开和关闭游标" class="headerlink" title="打开和关闭游标"></a>打开和关闭游标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">OPEN ordernumbers;</span><br><span class="line">CLOSE ordernumbers;</span><br></pre></td></tr></table></figure>

<h3 id="使用游标"><a href="#使用游标" class="headerlink" title="使用游标"></a>使用游标</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line">CREATE PROCEDURE processorders () BEGIN</span><br><span class="line">    DECLARE</span><br><span class="line">        done BOOLEAN DEFAULT 0;</span><br><span class="line">    DECLARE</span><br><span class="line">        o INT;</span><br><span class="line">    DECLARE</span><br><span class="line">        t DECIMAL ( 8, 2 );</span><br><span class="line">    DECLARE</span><br><span class="line">        ordernumbers CURSOR FOR</span><br><span class="line">    SELECT</span><br><span class="line">        order_num </span><br><span class="line">    FROM</span><br><span class="line">        orders;</span><br><span class="line">    DECLARE</span><br><span class="line">        CONTINUE HANDLER FOR SQLSTATE &#x27;02000&#x27; </span><br><span class="line">        SET done = 1;</span><br><span class="line">    CREATE TABLE</span><br><span class="line">    IF NOT EXISTS ordertotals (</span><br><span class="line">            order_num INT,</span><br><span class="line">            total DECIMAL ( 8, 2 ));</span><br><span class="line">    OPEN ordernumbers;</span><br><span class="line">    REPEAT</span><br><span class="line">            FETCH ordernumbers INTO o;</span><br><span class="line">            CALL ordertotal ( o, 1, t );</span><br><span class="line">            INSERT INTO ordertotals ( order_num, total )</span><br><span class="line">            VALUES</span><br><span class="line">                ( o, t );</span><br><span class="line">    UNTIL done END REPEAT;</span><br><span class="line">    CLOSE ordernumbers;</span><br><span class="line">END;</span><br></pre></td></tr></table></figure>

<h2 id="触发器"><a href="#触发器" class="headerlink" title="触发器"></a>触发器</h2><p>在某个表发生更改时自动处理，这就是触发器。</p>
<p>触发器只会响应 DELETE、INSERT、UPDATE 从而自动执行一条或多条 SQL 语句。</p>
<p>每个表每个事件每次只允许一个触发器，因此每个表最多支持 6 个触发器。</p>
<h3 id="创建触发器"><a href="#创建触发器" class="headerlink" title="创建触发器"></a>创建触发器</h3><p>需要给出 4 个必要的信息：</p>
<ul>
<li>触发器名，每个表唯一；</li>
<li>触发器关联的表；</li>
<li>触发器应该响应的动作；</li>
<li>触发器何时执行；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER newproduct AFTER INSERT ON products </span><br><span class="line">FOR EACH ROW</span><br><span class="line">SELECT</span><br><span class="line">    &#x27;Product added&#x27; INTO @result;</span><br></pre></td></tr></table></figure>

<h3 id="删除触发器"><a href="#删除触发器" class="headerlink" title="删除触发器"></a>删除触发器</h3><figure class="highlight haxe"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">DROP TRIGGER <span class="keyword">new</span><span class="type">product</span>;</span><br></pre></td></tr></table></figure>

<h3 id="使用触发器"><a href="#使用触发器" class="headerlink" title="使用触发器"></a>使用触发器</h3><h4 id="INSERT-触发器"><a href="#INSERT-触发器" class="headerlink" title="INSERT 触发器"></a>INSERT 触发器</h4><ul>
<li>INSERT 触发器内可以引用一个名为 NEW 的虚拟表，访问被插入的行；</li>
<li>BEFORE INSERT 触发器内，NEW 中的值也可以被更新；</li>
<li>对于 AUTO_INCREMENT 列，NEW 在 INSERT 执行前包含0，执行之后包含自动生成的值；</li>
</ul>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">CREATE TRIGGER newproduct AFTER INSERT ON products </span><br><span class="line">FOR EACH ROW</span><br><span class="line">SELECT</span><br><span class="line">    NEW.prod_id INTO @result;</span><br></pre></td></tr></table></figure>

<h4 id="DELETE-触发器"><a href="#DELETE-触发器" class="headerlink" title="DELETE 触发器"></a>DELETE 触发器</h4><ul>
<li>DELETE 触发器内可以引用一个名为 OLD 的虚拟表，访问被删除的行；</li>
<li>OLD 中的值都是只读的，不能更新；</li>
</ul>
<h4 id="UPDATE-触发器"><a href="#UPDATE-触发器" class="headerlink" title="UPDATE 触发器"></a>UPDATE 触发器</h4><ul>
<li>UPDATE 触发器内可以引用一个 OLD 的虚拟表访问更新前的值，NEW 的虚拟表访问更新后的值；</li>
<li>OLD 中的值都是只读的，不能更新；</li>
<li>NEW 中的值可以被更新；</li>
</ul>
<h2 id="事务"><a href="#事务" class="headerlink" title="事务"></a>事务</h2><p>事务处理机制用来管理成批执行的 SQL 操作，保证数据库中不存在不完整操作的结果。一批 SQL 操作要么整体执行完毕，要么都不执行。</p>
<h3 id="事务的开始"><a href="#事务的开始" class="headerlink" title="事务的开始"></a>事务的开始</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">START TRANSACTION;</span><br></pre></td></tr></table></figure>

<h3 id="ROLLBACK"><a href="#ROLLBACK" class="headerlink" title="ROLLBACK"></a>ROLLBACK</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">SELECT * FROM products;</span><br><span class="line">START TRANSACTION;</span><br><span class="line">DELETE FROM products;</span><br><span class="line">SELECT * FROM products;</span><br><span class="line">ROLLBACK;</span><br><span class="line">SELECT * FROM products;</span><br></pre></td></tr></table></figure>

<p>ROLLBACK 用来回退 SQL 操作，只能在事务处理内使用。</p>
<h3 id="COMMIT"><a href="#COMMIT" class="headerlink" title="COMMIT"></a>COMMIT</h3><p>在事务内，提交不会隐含执行，必须使用 COMMIT 显式提交。</p>
<h3 id="保留点"><a href="#保留点" class="headerlink" title="保留点"></a>保留点</h3><p>类似于存档，用于回退时需要回到哪个执行阶段。</p>
<p>SAVEPOINT point；创建保留点。</p>
<p>ROLLBACK TO point；回退到指定的保留点。</p>
<h3 id="更改默认的提交行为"><a href="#更改默认的提交行为" class="headerlink" title="更改默认的提交行为"></a>更改默认的提交行为</h3><p>默认的 SQL 行为是自动提交的，可以通过修改 autocommit 标志修改这种行为。</p>
<p>set autocommit = 0；</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/MySQL/" rel="tag"># MySQL</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/02/03/%E5%8D%9A%E5%AE%A2%E5%A4%A7%E6%9D%82%E7%83%A9/" rel="prev" title="博客大杂烩">
      <i class="fa fa-chevron-left"></i> 博客大杂烩
    </a></div>
      <div class="post-nav-item"></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          文章目录
        </li>
        <li class="sidebar-nav-overview">
          站点概览
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#SELECT"><span class="nav-number">1.</span> <span class="nav-text">SELECT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E5%8D%95%E4%B8%AA%E5%88%97"><span class="nav-number">1.1.</span> <span class="nav-text">检索单个列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E5%A4%9A%E4%B8%AA%E5%88%97"><span class="nav-number">1.2.</span> <span class="nav-text">检索多个列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E6%89%80%E6%9C%89%E5%88%97"><span class="nav-number">1.3.</span> <span class="nav-text">检索所有列</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%A3%80%E7%B4%A2%E4%B8%8D%E5%90%8C%E7%9A%84%E5%80%BC"><span class="nav-number">1.4.</span> <span class="nav-text">检索不同的值</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%99%90%E5%88%B6%E6%A3%80%E7%B4%A2%E7%BB%93%E6%9E%9C%E7%9A%84%E6%95%B0%E9%87%8F"><span class="nav-number">1.5.</span> <span class="nav-text">限制检索结果的数量</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#ORDER-BY"><span class="nav-number">2.</span> <span class="nav-text">ORDER BY</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8E%92%E5%BA%8F%E6%95%B0%E6%8D%AE"><span class="nav-number">2.1.</span> <span class="nav-text">排序数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E5%A4%9A%E4%B8%AA%E5%88%97%E6%8E%92%E5%BA%8F%E6%95%B0%E6%8D%AE"><span class="nav-number">2.2.</span> <span class="nav-text">按多个列排序数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%89%E5%88%97%E4%BD%8D%E7%BD%AE%E6%8E%92%E5%BA%8F"><span class="nav-number">2.3.</span> <span class="nav-text">按列位置排序</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E6%8E%92%E5%BA%8F%E6%96%B9%E5%90%91"><span class="nav-number">2.4.</span> <span class="nav-text">指定排序方向</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#WHERE"><span class="nav-number">3.</span> <span class="nav-text">WHERE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E6%95%B0%E6%8D%AE"><span class="nav-number">3.1.</span> <span class="nav-text">过滤数据</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E7%BB%84%E5%90%88-WHERE-%E5%AD%90%E5%8F%A5"><span class="nav-number">3.2.</span> <span class="nav-text">组合 WHERE 子句</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8C%87%E5%AE%9A%E6%9D%A1%E4%BB%B6%E8%8C%83%E5%9B%B4"><span class="nav-number">3.3.</span> <span class="nav-text">指定条件范围</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%90%A6%E5%AE%9A%E6%9D%A1%E4%BB%B6"><span class="nav-number">3.4.</span> <span class="nav-text">否定条件</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#LIKE"><span class="nav-number">4.</span> <span class="nav-text">LIKE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6"><span class="nav-number">4.1.</span> <span class="nav-text">% 通配符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%80%9A%E9%85%8D%E7%AC%A6-1"><span class="nav-number">4.2.</span> <span class="nav-text">_ 通配符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#REGEXP"><span class="nav-number">5.</span> <span class="nav-text">REGEXP</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%9F%BA%E6%9C%AC%E5%AD%97%E7%AC%A6%E5%8C%B9%E9%85%8D"><span class="nav-number">5.1.</span> <span class="nav-text">基本字符匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#OR-%E5%8C%B9%E9%85%8D"><span class="nav-number">5.2.</span> <span class="nav-text">OR 匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D"><span class="nav-number">5.3.</span> <span class="nav-text">[] 匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%8C%83%E5%9B%B4%E5%8C%B9%E9%85%8D"><span class="nav-number">5.4.</span> <span class="nav-text">范围匹配</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6"><span class="nav-number">5.5.</span> <span class="nav-text">匹配特殊字符</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%AD%97%E7%AC%A6%E7%B1%BB"><span class="nav-number">5.6.</span> <span class="nav-text">匹配字符类</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%8C%B9%E9%85%8D%E5%A4%9A%E4%B8%AA%E5%AE%9E%E4%BE%8B"><span class="nav-number">5.7.</span> <span class="nav-text">匹配多个实例</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%AE%9A%E4%BD%8D%E7%AC%A6"><span class="nav-number">5.8.</span> <span class="nav-text">定位符</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%8B%BC%E6%8E%A5%E5%AD%97%E6%AE%B5"><span class="nav-number">6.</span> <span class="nav-text">拼接字段</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#Concat"><span class="nav-number">6.1.</span> <span class="nav-text">Concat()</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E5%88%AB%E5%90%8D"><span class="nav-number">6.2.</span> <span class="nav-text">使用别名</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5"><span class="nav-number">7.</span> <span class="nav-text">计算字段</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%87%BD%E6%95%B0"><span class="nav-number">8.</span> <span class="nav-text">函数</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%96%87%E6%9C%AC%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">8.1.</span> <span class="nav-text">文本处理函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%97%A5%E6%9C%9F%E4%B8%8E%E6%97%B6%E9%97%B4%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">8.2.</span> <span class="nav-text">日期与时间处理函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%95%B0%E5%80%BC%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0"><span class="nav-number">8.3.</span> <span class="nav-text">数值处理函数</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%81%9A%E9%9B%86%E5%87%BD%E6%95%B0"><span class="nav-number">8.4.</span> <span class="nav-text">聚集函数</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#GROUP-BY"><span class="nav-number">9.</span> <span class="nav-text">GROUP BY</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E8%BF%87%E6%BB%A4%E5%88%86%E7%BB%84"><span class="nav-number">9.1.</span> <span class="nav-text">过滤分组</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.</span> <span class="nav-text">子查询</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%9C%E4%B8%BA%E8%AE%A1%E7%AE%97%E5%AD%97%E6%AE%B5%E4%BD%BF%E7%94%A8%E5%AD%90%E6%9F%A5%E8%AF%A2"><span class="nav-number">10.1.</span> <span class="nav-text">作为计算字段使用子查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%81%94%E7%BB%93"><span class="nav-number">11.</span> <span class="nav-text">联结</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E7%BB%84%E5%90%88%E6%9F%A5%E8%AF%A2"><span class="nav-number">12.</span> <span class="nav-text">组合查询</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%85%A8%E6%96%87%E6%9C%AC%E6%90%9C%E7%B4%A2"><span class="nav-number">13.</span> <span class="nav-text">全文本搜索</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E8%AF%A2%E6%89%A9%E5%B1%95"><span class="nav-number">13.1.</span> <span class="nav-text">查询扩展</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%B8%83%E5%B0%94%E6%96%87%E6%9C%AC%E6%9F%A5%E8%AF%A2"><span class="nav-number">13.2.</span> <span class="nav-text">布尔文本查询</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#INSERT"><span class="nav-number">14.</span> <span class="nav-text">INSERT</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%8F%92%E5%85%A5%E6%A3%80%E7%B4%A2%E5%87%BA%E7%9A%84%E6%95%B0%E6%8D%AE"><span class="nav-number">14.1.</span> <span class="nav-text">插入检索出的数据</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#UPDATE"><span class="nav-number">15.</span> <span class="nav-text">UPDATE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#DELETE"><span class="nav-number">15.1.</span> <span class="nav-text">DELETE</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#CREATE"><span class="nav-number">16.</span> <span class="nav-text">CREATE</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E8%A1%A8"><span class="nav-number">16.1.</span> <span class="nav-text">更新表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A1%A8"><span class="nav-number">16.2.</span> <span class="nav-text">删除表</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E9%87%8D%E5%91%BD%E5%90%8D%E8%A1%A8"><span class="nav-number">16.3.</span> <span class="nav-text">重命名表</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%86%E5%9B%BE"><span class="nav-number">17.</span> <span class="nav-text">视图</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%96%B0%E8%A7%86%E5%9B%BE"><span class="nav-number">17.1.</span> <span class="nav-text">更新视图</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">18.</span> <span class="nav-text">存储过程</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">18.1.</span> <span class="nav-text">创建存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%A7%E8%A1%8C%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">18.2.</span> <span class="nav-text">执行存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">18.3.</span> <span class="nav-text">删除存储过程</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9F%A5%E7%9C%8B%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B"><span class="nav-number">18.4.</span> <span class="nav-text">查看存储过程</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E6%B8%B8%E6%A0%87"><span class="nav-number">19.</span> <span class="nav-text">游标</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E6%B8%B8%E6%A0%87"><span class="nav-number">19.1.</span> <span class="nav-text">创建游标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%89%93%E5%BC%80%E5%92%8C%E5%85%B3%E9%97%AD%E6%B8%B8%E6%A0%87"><span class="nav-number">19.2.</span> <span class="nav-text">打开和关闭游标</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E6%B8%B8%E6%A0%87"><span class="nav-number">19.3.</span> <span class="nav-text">使用游标</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.</span> <span class="nav-text">触发器</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%9B%E5%BB%BA%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.1.</span> <span class="nav-text">创建触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E5%88%A0%E9%99%A4%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.2.</span> <span class="nav-text">删除触发器</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BD%BF%E7%94%A8%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.3.</span> <span class="nav-text">使用触发器</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#INSERT-%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.3.1.</span> <span class="nav-text">INSERT 触发器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#DELETE-%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.3.2.</span> <span class="nav-text">DELETE 触发器</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#UPDATE-%E8%A7%A6%E5%8F%91%E5%99%A8"><span class="nav-number">20.3.3.</span> <span class="nav-text">UPDATE 触发器</span></a></li></ol></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1"><span class="nav-number">21.</span> <span class="nav-text">事务</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%BC%80%E5%A7%8B"><span class="nav-number">21.1.</span> <span class="nav-text">事务的开始</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#ROLLBACK"><span class="nav-number">21.2.</span> <span class="nav-text">ROLLBACK</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#COMMIT"><span class="nav-number">21.3.</span> <span class="nav-text">COMMIT</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E4%BF%9D%E7%95%99%E7%82%B9"><span class="nav-number">21.4.</span> <span class="nav-text">保留点</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#%E6%9B%B4%E6%94%B9%E9%BB%98%E8%AE%A4%E7%9A%84%E6%8F%90%E4%BA%A4%E8%A1%8C%E4%B8%BA"><span class="nav-number">21.5.</span> <span class="nav-text">更改默认的提交行为</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
    <img class="site-author-image" itemprop="image" alt="hbinnn"
      src="/images/avatar.jpg">
  <p class="site-author-name" itemprop="name">hbinnn</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives">
          <span class="site-state-item-count">4</span>
          <span class="site-state-item-name">日志</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">3</span>
        <span class="site-state-item-name">分类</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">5</span>
        <span class="site-state-item-name">标签</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/hbinnn" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;hbinnn" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:lx1003129759@gmail.com" title="E-Mail → mailto:lx1003129759@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>
        <div class="back-to-top motion-element">
          <i class="fa fa-arrow-up"></i>
          <span>0%</span>
        </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">hbinnn</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-chart-area"></i>
    </span>
    <span title="站点总字数">27k</span>
    <span class="post-meta-divider">|</span>
    <span class="post-meta-item-icon">
      <i class="fa fa-coffee"></i>
    </span>
    <span title="站点阅读时长">48 分钟</span>
</div>

<!--
  <div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://pisces.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Pisces</a> 强力驱动
  </div>
-->

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
